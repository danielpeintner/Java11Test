// set JAVA_HOME=C:\Program Files\Java\jdk-11.0.5+10

plugins {
    id 'application'
    id 'org.openjfx.javafxplugin' version '0.0.8'
    id 'org.beryx.runtime' version '1.8.0'
}

dependencies {
    // test dependencies
    testCompile group: 'junit', name: 'junit', version: '4.12'
}

repositories {
    mavenCentral()
}

javafx {
    version = '13.0.1'
    modules = ['javafx.controls']
}

version = '19.12.04'
def company = 'My Company'

mainClassName = "com.example.hellofx.Launcher"
applicationName = 'hello-fx'

application {
    // mainClassName = "com.example.hellofx.Launcher"
    // applicationName = 'hello-fx'
}

runtime {
    options = ['--strip-debug', '--compress', '2', '--no-header-files', '--no-man-pages']
    jpackage {
        imageName = applicationName // "hello-fx"
        // Set the environment property BADASS_JLINK_JPACKAGE_HOME or explicitly configure the below property
        def os = org.gradle.internal.os.OperatingSystem.current()
        if(os.macOsX) {
            jpackageHome = '/Library/Java/JavaVirtualMachines/jdk-14-jpackage.jdk/Contents/Home'
        } else if(os.windows) {
            jpackageHome = 'C:/Program Files/Java/jdk-14-jpackage'
        }
        jvmArgs = []
        // jvmArgs = ['-Dfxgl.sliding.puzzle.dummy=nothingElse', '-Dfxgl.sliding.puzzle.title=somethingElse']
        installerOptions = [
                // '--file-associations', 'src/main/resources/associations.properties',
                '--app-version', version,
                '--vendor', company,
                '--copyright', company,
        ]
        if(os.macOsX) {
            imageOptions = ['--icon', 'src/main/deploy/package/macosx/hello.icns']
            installerOptions += [
/*
                '--mac-sign',
                '--mac-signing-key-user-name', System.getenv('SIGNING_KEY_USER_NAME'),
                '--mac-signing-keychain', System.getenv('SIGNING_KEYCHAIN_PATH')
*/
            ]
        } else if(os.windows) {
            imageOptions = ['--icon', 'src/main/deploy/package/windows/hello.ico']
            installerType = 'msi'
            installerOptions += [
                    '--win-per-user-install',
                    // , '--win-dir-chooser'
                    '--win-menu',
                    '--win-menu-group', company,
                    '--win-shortcut',
                    // '--win-upgrade-uuid', '027D194C-359B-11B2-A85C-C5D71105C10C',
            ]
        }
    }
}
